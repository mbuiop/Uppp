<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>پنل مدیریت</title>
    <link href="https://fonts.googleapis.com/css2?family=Iranian+Sans&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Iranian Sans', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .tab-btn {
            background: none;
            border: none;
            color: white;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 16px;
            position: relative;
        }
        
        .tab-btn.active {
            color: #8f94fb;
        }
        
        .tab-btn.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 100%;
            height: 3px;
            background: #8f94fb;
        }
        
        .tab-content {
            display: none;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        }
        
        .tab-content.active {
            display: block;
        }
        
        .pending-sites, .approved-sites {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }
        
        .site-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .site-card h3 {
            margin-bottom: 10px;
            color: #8f94fb;
        }
        
        .site-card p {
            margin-bottom: 10px;
            font-size: 14px;
        }
        
        .site-card a {
            color: #4e54c8;
            text-decoration: none;
            display: inline-block;
            margin-top: 10px;
        }
        
        .action-btn {
            background: linear-gradient(145deg, #4e54c8, #8f94fb);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
            margin-right: 5px;
        }
        
        .reject-btn {
            background: linear-gradient(145deg, #ff4757, #ff6b81);
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-size: 16px;
        }
        
        .form-group input, .form-group textarea, .form-group select {
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            border: none;
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }
        
        .submit-btn {
            background: linear-gradient(145deg, #4e54c8, #8f94fb);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 10px;
        }
        
        .signals-list, .currencies-list, .indicators-list {
            display: grid;
            gap: 15px;
            margin-top: 20px;
        }
        
        .signal-card, .currency-card, .indicator-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
        }
        
        .signal-card h3, .currency-card h3, .indicator-card h3 {
            color: #8f94fb;
            margin-bottom: 10px;
        }
        
        .signal-card p, .currency-card p, .indicator-card p {
            margin-bottom: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>پنل مدیریت</h1>
        </div>
        
        <div class="tabs">
            <button class="tab-btn active" onclick="openTab('sites-tab')">سایت‌ها</button>
            <button class="tab-btn" onclick="openTab('signals-tab')">سیگنال‌ها</button>
            <button class="tab-btn" onclick="openTab('currencies-tab')">ارزها</button>
            <button class="tab-btn" onclick="openTab('indicators-tab')">اندیکاتورها</button>
        </div>
        
        <!-- تب سایت‌ها -->
        <div id="sites-tab" class="tab-content active">
            <h2>سایت‌های در انتظار تایید</h2>
            <div id="pending-sites" class="pending-sites"></div>
            
            <h2 style="margin-top: 30px;">سایت‌های تایید شده</h2>
            <div id="approved-sites" class="approved-sites"></div>
        </div>
        
        <!-- تب سیگنال‌ها -->
        <div id="signals-tab" class="tab-content">
            <h2>افزودن سیگنال جدید</h2>
            <div class="form-group">
                <label for="signal-currency">نام ارز:</label>
                <input type="text" id="signal-currency" placeholder="مثال: Bitcoin">
            </div>
            <div class="form-group">
                <label for="signal-leverage">اهرم:</label>
                <input type="text" id="signal-leverage" placeholder="مثال: 10x">
            </div>
            <div class="form-group">
                <label for="signal-entry">نقطه ورود:</label>
                <input type="text" id="signal-entry" placeholder="مثال: 42000">
            </div>
            <div class="form-group">
                <label for="signal-stop-loss">حد ضرر:</label>
                <input type="text" id="signal-stop-loss" placeholder="مثال: 40000">
            </div>
            <div class="form-group">
                <label for="signal-take-profit">حد سود:</label>
                <input type="text" id="signal-take-profit" placeholder="مثال: 45000">
            </div>
            <button class="submit-btn" onclick="addSignal()">ثبت سیگنال</button>
            
            <h2 style="margin-top: 30px;">سیگنال‌های اخیر</h2>
            <div id="signals-list" class="signals-list"></div>
        </div>
        
        <!-- تب ارزها -->
        <div id="currencies-tab" class="tab-content">
            <h2>افزودن ارز جدید</h2>
            <div class="form-group">
                <label for="currency-name">نام ارز:</label>
                <input type="text" id="currency-name" placeholder="مثال: Bitcoin">
            </div>
            <div class="form-group">
                <label for="currency-symbol">نماد:</label>
                <input type="text" id="currency-symbol" placeholder="مثال: BTC">
            </div>
            <div class="form-group">
                <label for="currency-year">سال ساخت:</label>
                <input type="text" id="currency-year" placeholder="مثال: 2009">
            </div>
            <div class="form-group">
                <label for="currency-creator">سازنده:</label>
                <input type="text" id="currency-creator" placeholder="مثال: ساتوشی ناکاموتو">
            </div>
            <div class="form-group">
                <label for="currency-description">توضیحات (3 خط):</label>
                <textarea id="currency-description" rows="3" placeholder="توضیحات درباره ارز"></textarea>
            </div>
            <button class="submit-btn" onclick="addCurrency()">ثبت ارز</button>
            
            <h2 style="margin-top: 30px;">ارزهای موجود</h2>
            <div id="currencies-list" class="currencies-list"></div>
        </div>
        
        <!-- تب اندیکاتورها -->
        <div id="indicators-tab" class="tab-content">
            <h2>افزودن اندیکاتور جدید</h2>
            <div class="form-group">
                <label for="indicator-name">نام اندیکاتور:</label>
                <input type="text" id="indicator-name" placeholder="مثال: Moving Average">
            </div>
            <div class="form-group">
                <label for="indicator-use">کاربرد:</label>
                <input type="text" id="indicator-use" placeholder="مثال: تشخیص روند">
            </div>
            <div class="form-group">
                <label for="indicator-description">توضیحات (3 خط):</label>
                <textarea id="indicator-description" rows="3" placeholder="توضیحات درباره اندیکاتور"></textarea>
            </div>
            <button class="submit-btn" onclick="addIndicator()">ثبت اندیکاتور</button>
            
            <h2 style="margin-top: 30px;">اندیکاتورهای موجود</h2>
            <div id="indicators-list" class="indicators-list"></div>
        </div>
    </div>

    <script>
        // باز کردن تب مورد نظر
        function openTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById(tabId).classList.add('active');
            event.currentTarget.classList.add('active');
            
            // بارگذاری محتوای مربوطه
            if (tabId === 'sites-tab') {
                loadPendingSites();
                loadApprovedSites();
            } else if (tabId === 'signals-tab') {
                loadSignals();
            } else if (tabId === 'currencies-tab') {
                loadCurrencies();
            } else if (tabId === 'indicators-tab') {
                loadIndicators();
            }
        }
        
        // بارگذاری سایت‌های در انتظار تایید
        function loadPendingSites() {
            fetch('/get_sites')
            .then(response => response.json())
            .then(sites => {
                const container = document.getElementById('pending-sites');
                container.innerHTML = '';
                
                const pendingSites = sites.filter(site => !site.approved);
                
                pendingSites.forEach(site => {
                    const siteCard = document.createElement('div');
                    siteCard.className = 'site-card';
                    siteCard.innerHTML = `
                        <h3>${site.name}</h3>
                        <p>${site.description}</p>
                        <a href="${site.url}" target="_blank">مشاهده سایت</a>
                        <div>
                            <button class="action-btn" onclick="approveSite('${site.url}')">تایید</button>
                            <button class="action-btn reject-btn" onclick="rejectSite('${site.url}')">رد</button>
                        </div>
                    `;
                    container.appendChild(siteCard);
                });
            });
        }
        
        // بارگذاری سایت‌های تایید شده
        function loadApprovedSites() {
            fetch('/get_sites')
            .then(response => response.json())
            .then(sites => {
                const container = document.getElementById('approved-sites');
                container.innerHTML = '';
                
                const approvedSites = sites.filter(site => site.approved);
                
                approvedSites.forEach(site => {
                    const siteCard = document.createElement('div');
                    siteCard.className = 'site-card';
                    siteCard.innerHTML = `
                        <h3>${site.name}</h3>
                        <p>${site.description}</p>
                        <a href="${site.url}" target="_blank">مشاهده سایت</a>
                        <button class="action-btn reject-btn" onclick="removeSite('${site.url}')">حذف</button>
                    `;
                    container.appendChild(siteCard);
                });
            });
        }
        
        // تایید سایت
        function approveSite(siteUrl) {
            fetch('/approve_site', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ url: siteUrl })
            })
            .then(response => response.json())
            .then(data => {
                alert('سایت با موفقیت تایید شد');
                loadPendingSites();
                loadApprovedSites();
            })
            .catch(error => {
                console.error('Error:', error);
                alert('خطا در تایید سایت');
            });
        }
        
        // رد سایت
        function rejectSite(siteUrl) {
            // در اینجا می‌توانید کد حذف سایت از لیست انتظار را اضافه کنید
            alert('سایت رد شد');
            loadPendingSites();
        }
        
        // حذف سایت
        function removeSite(siteUrl) {
            // در اینجا می‌توانید کد حذف سایت از لیست تایید شده را اضافه کنید
            alert('سایت حذف شد');
            loadApprovedSites();
        }
        
        // افزودن سیگنال جدید
        function addSignal() {
            const currency = document.getElementById('signal-currency').value;
            const leverage = document.getElementById('signal-leverage').value;
            const entry = document.getElementById('signal-entry').value;
            const stopLoss = document.getElementById('signal-stop-loss').value;
            const takeProfit = document.getElementById('signal-take-profit').value;
            
            if (!currency || !leverage || !entry || !stopLoss || !takeProfit) {
                alert('لطفا تمام فیلدها را پر کنید');
                return;
            }
            
            const signalData = {
                currency,
                leverage,
                entry,
                stopLoss,
                takeProfit,
                timestamp: new Date().toISOString()
            };
            
            fetch('/add_signal', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(signalData)
            })
            .then(response => response.json())
            .then(data => {
                alert('سیگنال با موفقیت ثبت شد');
                document.getElementById('signal-currency').value = '';
                document.getElementById('signal-leverage').value = '';
                document.getElementById('signal-entry').value = '';
                document.getElementById('signal-stop-loss').value = '';
                document.getElementById('signal-take-profit').value = '';
                loadSignals();
            })
            .catch(error => {
                console.error('Error:', error);
                alert('خطا در ثبت سیگنال');
            });
        }
        
        // بارگذاری سیگنال‌ها
        function loadSignals() {
            fetch('/get_signals')
            .then(response => response.json())
            .then(signals => {
                const container = document.getElementById('signals-list');
                container.innerHTML = '';
                
                signals.reverse().forEach(signal => {
                    const signalCard = document.createElement('div');
                    signalCard.className = 'signal-card';
                    signalCard.innerHTML = `
                        <h3>${signal.currency}</h3>
                        <p><strong>اهرم:</strong> ${signal.leverage}</p>
                        <p><strong>نقطه ورود:</strong> ${signal.entry}</p>
                        <p><strong>حد ضرر:</strong> ${signal.stopLoss}</p>
                        <p><strong>حد سود:</strong> ${signal.takeProfit}</p>
                        <p><small>${new Date(signal.timestamp).toLocaleString()}</small></p>
                    `;
                    container.appendChild(signalCard);
                });
            });
        }
        
        // افزودن ارز جدید
        function addCurrency() {
            const name = document.getElementById('currency-name').value;
            const symbol = document.getElementById('currency-symbol').value;
            const year = document.getElementById('currency-year').value;
            const creator = document.getElementById('currency-creator').value;
            const description = document.getElementById('currency-description').value;
            
            if (!name || !symbol || !year || !creator || !description) {
                alert('لطفا تمام فیلدها را پر کنید');
                return;
            }
            
            const currencyData = {
                name,
                symbol,
                year,
                creator,
                description
            };
            
            fetch('/add_currency', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(currencyData)
            })
            .then(response => response.json())
            .then(data => {
                alert('ارز با موفقیت ثبت شد');
                document.getElementById('currency-name').value = '';
                document.getElementById('currency-symbol').value = '';
                document.getElementById('currency-year').value = '';
                document.getElementById('currency-creator').value = '';
                document.getElementById('currency-description').value = '';
                loadCurrencies();
            })
            .catch(error => {
                console.error('Error:', error);
                alert('خطا در ثبت ارز');
            });
        }
        
        // بارگذاری ارزها
        function loadCurrencies() {
            fetch('/get_currencies')
            .then(response => response.json())
            .then(currencies => {
                const container = document.getElementById('currencies-list');
                container.innerHTML = '';
                
                currencies.reverse().forEach(currency => {
                    const currencyCard = document.createElement('div');
                    currencyCard.className = 'currency-card';
                    currencyCard.innerHTML = `
                        <h3>${currency.name} (${currency.symbol})</h3>
                        <p><strong>سال ساخت:</strong> ${currency.year}</p>
                        <p><strong>سازنده:</strong> ${currency.creator}</p>
                        <p>${currency.description}</p>
                    `;
                    container.appendChild(currencyCard);
                });
            });
        }
        
        // افزودن اندیکاتور جدید
        function addIndicator() {
            const name = document.getElementById('indicator-name').value;
            const use = document.getElementById('indicator-use').value;
            const description = document.getElementById('indicator-description').value;
            
            if (!name || !use || !description) {
                alert('لطفا تمام فیلدها را پر کنید');
                return;
            }
            
            const indicatorData = {
                name,
                use,
                description
            };
            
            fetch('/add_indicator', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(indicatorData)
            })
            .then(response => response.json())
            .then(data => {
                alert('اندیکاتور با موفقیت ثبت شد');
                document.getElementById('indicator-name').value = '';
                document.getElementById('indicator-use').value = '';
                document.getElementById('indicator-description').value = '';
                loadIndicators();
            })
            .catch(error => {
                console.error('Error:', error);
                alert('خطا در ثبت اندیکاتور');
            });
        }
        
        // بارگذاری اندیکاتورها
        function loadIndicators() {
            fetch('/get_indicators')
            .then(response => response.json())
            .then(indicators => {
                const container = document.getElementById('indicators-list');
                container.innerHTML = '';
                
                indicators.reverse().forEach(indicator => {
                    const indicatorCard = document.createElement('div');
                    indicatorCard.className = 'indicator-card';
                    indicatorCard.innerHTML = `
                        <h3>${indicator.name}</h3>
                        <p><strong>کاربرد:</strong> ${indicator.use}</p>
                        <p>${indicator.description}</p>
                    `;
                    container.appendChild(indicatorCard);
                });
            });
        }
        
        // بارگذاری اولیه داده‌ها
        document.addEventListener('DOMContentLoaded', function() {
            loadPendingSites();
            loadApprovedSites();
        });
    </script>
</body>
</html>